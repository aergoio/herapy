language: python
matrix:
  include:
    - python: 3.7
      dist: xenial

services:
  - docker

# command to install dependencies
install:
  - pip install -r requirements_dev.txt
  - make install

before_script:
  - docker-compose -f ./tests/local_dpos_testnet/docker-compose.yml up -d&
  - aergo_docker_pid=$!
  - sleep 10

# command to run tests
script:
  - make coverage

after_script:
  - kill $aergo_docker_pid
  - make clean_local_testnets

after-success: 
  - codecov -e CODECOV_TOKEN

notifications:
  email: false
  slack:
    rooms: blocko:LwABz6vDzniWNDuDgtYIeqrf
    on_success: change
    on_failure: always 
